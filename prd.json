{
  "project": "reown",
  "description": "GitHub PR review alternative — native macOS GUI tool that understands impact, automates low-risk approvals, and keeps developers in flow",
  "intent": "docs/INTENT.md",
  "pillars": [
    "review-support: 変更の影響範囲・リスク把握、関連差分のみ表示、レビューパターン記憶",
    "local-gui: worktree/agent PR/同僚PRを同じ画面で切替なくレビュー",
    "automation: リスクに応じた自動approve、agent PRの自動merge",
    "dev-support: コードベースからタスク提案、ワンクリックworktree作成"
  ],
  "tasks": [
    {
      "id": "phase2-001",
      "title": "Add serde_json and reqwest dependencies",
      "description": "Add serde, serde_json, and reqwest (with rustls-tls) to Cargo.toml. Create a src/github/ module stub with mod.rs that re-exports types. Ensure cargo build succeeds with new deps.",
      "pillar": "local-gui",
      "priority": 1,
      "passed": true,
      "issue": null
    },
    {
      "id": "phase2-002",
      "title": "Implement GitHub API PR list fetching",
      "description": "In src/github/pull_request.rs, implement list_pull_requests(owner, repo, token) -> Result<Vec<PrInfo>> using reqwest to call GET /repos/{owner}/{repo}/pulls. PrInfo struct: number, title, author, state, head_branch, updated_at, additions, deletions, changed_files. Include unit tests with mock responses.",
      "pillar": "local-gui",
      "priority": 2,
      "passed": true,
      "issue": null
    },
    {
      "id": "phase2-003",
      "title": "Add PR list view to TUI",
      "description": "Add View::PullRequests variant. Create src/ui/pull_request.rs with render_pull_requests() following the same pattern as render_branches(). Add 'p' hotkey to switch to PR view. Show PR number, title, author, status. This is the single surface for reviewing agent PRs, Devin/Copilot PRs, and colleague PRs.",
      "pillar": "local-gui",
      "priority": 3,
      "passed": true,
      "issue": null
    },
    {
      "id": "phase2-004",
      "title": "Show PR diff in TUI",
      "description": "When Enter is pressed on a PR in the PR list view, fetch the PR diff via GitHub API and display it using the existing diff rendering infrastructure. Reuse ui::diff::render_diff with the fetched FileDiff data.",
      "pillar": "local-gui",
      "priority": 4,
      "passed": true,
      "issue": null
    },
    {
      "id": "phase2-007",
      "title": "Migrate from TUI to native macOS GUI — project scaffolding",
      "description": "Issue #6 identifies a major requirement misunderstanding: reown should be a native macOS GUI app, not a TUI. This task sets up the frontend foundation. Add a Tauri (or similar Rust-native GUI framework) project alongside the existing Rust backend. Configure the build to produce a native macOS .app bundle. The existing git2/reqwest backend logic in src/git/ and src/github/ is retained as the core library; only the presentation layer changes. This is the foundational step for the local-gui pillar: ローカルベースのGUIツールで画面の切り替えや移動なくレビューを行う.",
      "pillar": "local-gui",
      "priority": 5,
      "passed": true,
      "issue": 6
    },
    {
      "id": "phase2-010",
      "title": "Create GitHub issue templates with agent label",
      "description": "Design and create .github/ISSUE_TEMPLATE/ forms that automatically apply the 'agent' label. Design the form fields to be structured for easy agent consumption: clear title format, structured body sections (goal, context, acceptance criteria), and appropriate labels/assignee fields. Include at least a 'feature request' and 'bug report' template. Solves: agentラベルが入力されるようにして、agentとして指示を取り込みやすいように適切なformを設計する.",
      "pillar": "dev-support",
      "priority": 6,
      "passed": true,
      "issue": 4
    },
    {
      "id": "phase2-011",
      "title": "Add planned label and priority comment to synced issues",
      "description": "Enhance the roadmap agent workflow (agent/loop.sh or a dedicated script) to provide feedback on GitHub issues after syncing them into prd.json. When an issue with the 'agent' label is incorporated into the task list: (1) apply a 'planned' label to the issue via GitHub API (gh issue edit --add-label planned), (2) post a comment on the issue summarizing the assigned priority, task ID, and planned approach. This closes the feedback loop so issue authors know their request was received and how it will be addressed. Solves: issueをシンクするだけではなくて、取り込み済みであればplanned labelをつけて、優先度や対応方針をコメントする.",
      "pillar": "dev-support",
      "priority": 7,
      "passed": true,
      "issue": 7
    },
    {
      "id": "phase2-012",
      "title": "タスク完了前のpush・PR内容検証を追加",
      "description": "Issue #11: agentがタスク完了を宣言する前に、(1) git statusでローカルがcleanであること、(2) ローカルのcommitが全てリモートにpushされていること、(3) PRのdiffが意図した変更を全て含んでいることを検証するステップをagent/loop.shに追加する。検証に失敗した場合はタスクをpassedにせず、不足分をpush・修正してから再検証する。Solves: localがcleanであり意図した修正が全てPRに反映できていることを確認する (INTENT: dev-support ワークフロー改善).",
      "pillar": "dev-support",
      "priority": 8,
      "passed": true,
      "issue": 11
    },
    {
      "id": "phase2-013",
      "title": "GUI移行の再確認 — TUIではなくネイティブGUIアプリとして構築",
      "description": "Issue #13: issue #6で指摘されたGUI要件が正しく実装されていなかった。reownはTUIではなくネイティブmacOS GUIアプリケーションである必要がある。phase2-007で足場は作ったが、実際にfrontendを構築しmacOSでネイティブ起動するバイナリを生成する必要がある。phase2-008/009と連携し、GUI views構築とネイティブバイナリパッケージングが完了していることを確認する。既存のphase2-008/009タスクの前提条件・ブロッカーとして機能する。Solves: TUIではなくてGUIです。ちゃんとfrontendも作ってmacでネイティブで起動するバイナリ作ってね (INTENT: local-gui).",
      "pillar": "local-gui",
      "priority": 9,
      "passed": false,
      "issue": 13
    },
    {
      "id": "phase2-014",
      "title": "CIやlocal git hookの効率化 — Rust未変更時のテストスキップ",
      "description": "Issue #14: Rustのソースコードに変更がない場合でもcargo testが実行されている非効率がある。CI (.github/workflows) およびlocal git hook (pre-commit等) を修正し、変更されたファイルの種類に応じて必要なcheckのみ実行するようにする。例: .mdや.github/のみ変更の場合はcargo test/clippyをスキップ。agent/やscriptのみ変更の場合はshellcheck等のみ実行。Solves: 適切に必要なcheckのみが行われるようにする (INTENT: dev-support ワークフロー改善).",
      "pillar": "dev-support",
      "priority": 10,
      "passed": false,
      "issue": 14
    },
    {
      "id": "phase2-015",
      "title": "agent loopのiteration interval短縮とrate limit対応",
      "description": "Issue #15: agent/loop.shのiteration間隔を30秒から5秒に変更する。ただし、Claude APIのrate limitに当たった場合を正しく検知し、エラーメッセージをログに出力してloopを安全に停止する仕組みを実装する。rate limitのHTTPステータスコード(429)やエラーメッセージを検出し、exponential backoffまたは即座停止を行う。Solves: intervalは5秒にして、rate limitに当たった時に正しくerror検知してloopが停止する設計にする (INTENT: dev-support ワークフロー改善).",
      "pillar": "dev-support",
      "priority": 11,
      "passed": false,
      "issue": 15
    },
    {
      "id": "phase2-016",
      "title": "ドキュメント・UI・issue templateの日本語化とi18n基盤",
      "description": "Issue #16: docs/配下のmarkdown、issue template、ユーザー向けUI文言を全て日本語化する。アプリケーション本体は将来のi18n対応を見据え、文字列リソースを外部化する仕組み(例: fluent-rs or 簡易なJSON/TOML辞書)を導入する。CLAUDE.mdのルールにも日本語コミュニケーション方針を追記する。Solves: docsに定義するmarkdownやUI, issue templateは全て日本語にする。i18n対応の仕組みを用意する (INTENT: dev-support / local-gui).",
      "pillar": "dev-support",
      "priority": 12,
      "passed": false,
      "issue": 16
    },
    {
      "id": "phase2-017",
      "title": "issue templateの拡張 — general feedback・優先度・種別フィールド追加",
      "description": "Issue #19: 既存のfeature request/bug report templateに加えて、general feedbackテンプレートを新規作成する。全templateに以下のフィールドを追加: (1) 優先度の指定 (high/medium/low dropdown)、(2) 依頼の種別 (プロダクト/開発環境/ワークフロー/その他 dropdown)、(3) 任意形式の自由入力テキストエリア。Solves: general feedback的なものも作って、優先度の指定、依頼の種別の設定と任意形式の入力 (INTENT: dev-support).",
      "pillar": "dev-support",
      "priority": 13,
      "passed": false,
      "issue": 19
    },
    {
      "id": "phase2-018",
      "title": "CI checkの待機時間延長とリトライ改善",
      "description": "Issue #21: agent/loop.shのCI check確認ロジックを改善する。(1) 最初のCI check確認までの待機時間を延長する（CIがまだ開始していない段階でチェックして毎回初回failになるのを防ぐ）。(2) デフォルトのリトライ回数を3回に増やす。(3) CI failedでリトライする際、既存のPRをcloseしてremote branchを削除してからmain loopに戻る（branch名の競合を防ぐ）。Solves: checkが早すぎる問題、CI failed時のbranch競合問題、3 attemptsまでOKにする (INTENT: dev-support ワークフロー改善).",
      "pillar": "dev-support",
      "priority": 1,
      "passed": true,
      "issue": 21
    },
    {
      "id": "phase2-005",
      "title": "Change impact summary per PR",
      "description": "For each PR, compute and display a summary: modules affected, lines changed, whether tests are included, public API surface changes. Show as a panel above the diff view. This replaces line-by-line review with intent-level understanding (INTENT: 変更の影響範囲・リスクの把握).",
      "pillar": "review-support",
      "priority": 15,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase2-006",
      "title": "Related-file diff filtering",
      "description": "When viewing a PR diff, allow filtering to show only files related to a selected change. Group files by module/directory. Pressing 'f' on a file shows only that file's diff and files that import/depend on it. Solves: 変更内容に関連するファイル差分だけが見れる.",
      "pillar": "review-support",
      "priority": 16,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-001",
      "title": "PR risk classification",
      "description": "Score PRs by risk: low (docs, tests, config only), medium (single module, with tests), high (multi-module, public API, no tests). Display risk level as colored badge in PR list. Risk definitions become the foundation for auto-approve decisions. Heuristics: file count, line count, test presence, module spread, public API changes.",
      "pillar": "review-support",
      "priority": 17,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-002",
      "title": "Configuration file support (.reown.toml)",
      "description": "Support .reown.toml in repo root. Fields: github.owner, github.repo, github.token_env, ui.default_view, ui.theme, review.risk_thresholds (customize low/medium/high boundaries), automation.auto_approve (off/low/medium), automation.auto_merge_agents (bool). Load on startup.",
      "pillar": "automation",
      "priority": 18,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-003",
      "title": "Auto-approve PRs by risk level",
      "description": "Based on .reown.toml automation.auto_approve setting, automatically approve PRs at or below the configured risk level. Show approve action in PR view with 'a' hotkey for manual approve. Log all auto-approve decisions. Default: disabled. Solves: リスクや影響範囲に応じて自動的にapproveする.",
      "pillar": "automation",
      "priority": 19,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-004",
      "title": "Auto-merge for agent PRs",
      "description": "When a PR is from a known coding agent (detected by author or label), and risk is within threshold, enable auto-merge after approval. Add 'm' hotkey for manual merge. Support squash merge. Solves: コーディングエージェントによるPRであればenable auto mergeも行い、マージする.",
      "pillar": "automation",
      "priority": 20,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-005",
      "title": "Review pattern memory and suggestion",
      "description": "Store review decisions (approve/request-changes + reason) in a local SQLite or JSON log. When reviewing a new PR, match against past patterns (same module, similar diff shape) and suggest likely review comments. Display suggestions as hints in the diff view. Solves: レビューパターンを記憶し、想定されるコメントをsuggestする.",
      "pillar": "review-support",
      "priority": 21,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-006",
      "title": "Development task suggestions from codebase",
      "description": "Scan codebase for TODO/FIXME comments, test coverage gaps, and clippy warnings. Surface as task suggestions in a new 't' view. Each suggestion: title, description, source file:line, estimated scope. Solves: コードベースからTODOやRoadmapを読み取り、開発タスクを提案する.",
      "pillar": "dev-support",
      "priority": 22,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase3-007",
      "title": "One-click worktree creation for suggested tasks",
      "description": "In the task suggestions view ('t'), pressing Enter on a task creates a new worktree + branch and opens a shell there. Reuse existing worktree::add_worktree(). Branch name derived from task title. Solves: 提案した開発タスクはワンクリックでworktreeを作成して開発を始められる.",
      "pillar": "dev-support",
      "priority": 23,
      "passed": false,
      "issue": null
    },
    {
      "id": "phase2-008",
      "title": "Migrate from TUI to native macOS GUI — frontend views",
      "description": "Rebuild the main views (worktree list, branch list, diff viewer, PR list) as GUI components in the new frontend framework. Each view should mirror the existing TUI functionality but with proper GUI layout — sidebar navigation, split panes, scrollable panels. Keyboard shortcuts should still work. The GUI must support viewing agent PRs, Devin/Copilot PRs, and colleague PRs in the same window without context switching (INTENT: 同じ場所で画面の切り替えや移動なく行える).",
      "pillar": "local-gui",
      "priority": 24,
      "passed": false,
      "issue": 6
    },
    {
      "id": "phase2-009",
      "title": "Migrate from TUI to native macOS GUI — native binary packaging",
      "description": "Configure the build pipeline to produce a self-contained macOS native binary (.app bundle). Ensure the app can be launched by double-clicking, includes proper Info.plist, icons, and code signing setup. The binary should embed the frontend assets and the Rust backend. Users should be able to run it without installing additional dependencies.",
      "pillar": "local-gui",
      "priority": 25,
      "passed": false,
      "issue": 6
    }
  ]
}
